
(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==='object'&&typeof module==='object')
module.exports=factory();else if(typeof define==='function'&&define.amd)
define([],factory);else if(typeof exports==='object')
exports["io"]=factory();else
root["io"]=factory();})(this,function(){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])
return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0);})
([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1);},function(module,exports,__webpack_require__){var JMessage=__webpack_require__(2);module.exports=JMessage;},function(module,exports,__webpack_require__){var Base64=__webpack_require__(3);var Channel=__webpack_require__(4);var JConstant=__webpack_require__(42);var MsgBuilder=__webpack_require__(43);var MsgContentBuilder=__webpack_require__(44);var MD5=__webpack_require__(45)();var Util=__webpack_require__(46);var JMessage=function(opt){var _opt=opt?opt:{};this.opts={address:_opt.address?_opt.address:JConstant.WSS_ADDRESS,debug:_opt.debug?true:false};this.channel=new Channel(this.opts);var self=this;this.syncTask=0;};JMessage.prototype.init=function(args){this.__checkConnect();var self=this;self.autoDiscon=true;if(args.flag===JConstant.SYNC_TYPE_OPEN){self.channel.sync_type=JConstant.SYNC_TYPE_OPEN;}else if(args.flag===JConstant.SYNC_TYPE_CLOSE){self.channel.sync_type=JConstant.SYNC_TYPE_CLOSE;}
this.channel.client.on(JConstant.EVENTS.INIT,function(data){if(data&&data.code==0){self.current_appkey=args.appkey;}
self.channel.client.removeListener(JConstant.EVENTS.INIT);});return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.INIT).setData(args).send();};JMessage.prototype.loginOut=function(){if(this.current_user){this.autoDiscon=false;clearTimeout(this.syncTask);this.channel.client.close();var dataCache=this.channel.dataCache;for(var i in dataCache){dataCache[i].cleanAckTimeout();dataCache[i].cleanRespTimeout();}
this.current_user=null;this.current_appkey=null;this.channel.init(this.channel.opts);}};JMessage.prototype.login=function(args){this.__checkInit();if(!args.is_md5){args.password=MD5(args.password);}
args.version=JConstant.SDK_VERSION;var self=this;this.channel.client.on(JConstant.EVENTS.LOGIN,function(data){if(data&&data.code==0){self.current_user=args.username;var lastSyncKey=Util.StorageUtils.getItem(args.username+'s_key');if(lastSyncKey){self.channel.sync_key=lastSyncKey;}
self.syncCheck({'sync_key':self.channel.sync_key,'sync_type':self.channel.sync_type}).onSuccess(function(da){if(da&&da.code==0){self.channel.sync_key=da.sync_key;self.channel.sync_type=da.sync_type;}});self.syncTask=setInterval(function(){self.syncCheck({'sync_key':self.channel.sync_key,'sync_type':self.channel.sync_type}).onSuccess(function(da){if(da&&da.code==0){self.channel.sync_key=da.sync_key;self.channel.sync_type=da.sync_type;}});},JConstant.SYNC_INTERVAL);self.channel.client.removeListener(JConstant.EVENTS.LOGIN);}});return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.LOGIN).setData(args).send();};JMessage.prototype.syncCheck=function(args){this.__checkLogin();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.SYNC_CHECK).setData(args).send();};JMessage.prototype.register=function(args){this.__checkInit();if(!args.is_md5){args.password=MD5(args.password);}
return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.REGISTER).setData(args).send();};JMessage.prototype.getUserInfo=function(args){this.__checkLogin();if(Util.StringUtils.isBlack(args.appkey)){args.appkey=this.current_appkey;}
return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_ACROSS_USER_INFO).setData(args).send();};JMessage.prototype.updateSelfInfo=function(args){this.__checkLogin();if(!Util.StringUtils.isBlack(args.avatar)){delete args.avatar;}
return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.UPDATE_SELF_INFO).setData(args).send();};JMessage.prototype.getResource=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_RESOURCE).setData(args).send();};JMessage.prototype.updateSelfAvatar=function(args){this.__checkLogin();var builder=new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.UPDATE_SELF_INFO);var self=this;this.__uploadFile({appkey:self.current_appkey,username:self.current_user,file:args.avatar,type:'image'},function(err,content){if(err){if(err.is_timeout)return builder.timeout&&builder.timeout(err.data);;return builder.fail&&builder.fail(err.data);}
builder.setData({avatar:content.media_id}).send();});return builder;};JMessage.prototype.updateSelfPwd=function(args){this.__checkLogin();if(!args.is_md5){args.old_pwd=MD5(args.old_pwd);args.new_pwd=MD5(args.new_pwd);}
return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.UPDATE_SELF_PWD).setData(args).send();};JMessage.prototype.getConversation=function(){this.__checkLogin();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_CONVERSATIONS).setData({}).send();};JMessage.prototype.sendSingleMsg=function(args){return this.__sendMsg({type:'single',target_id:args.target_username,target_name:args.target_nickname,content:args.content,extras:args.extras,appkey:args.appkey});};JMessage.prototype.sendGroupMsg=function(args){return this.__sendMsg({type:'group',target_id:args.target_gid,target_name:args.target_gname,content:args.content,extras:args.extras,at_list:args.at_list});};JMessage.prototype.sendSinglePic=function(args){return this.__sendPic({type:'single',target_id:args.target_username,target_name:args.target_nickname,file:args.image,extras:args.extras,appkey:args.appkey});};JMessage.prototype.sendGroupPic=function(args){return this.__sendPic({type:'group',target_id:args.target_gid,target_name:args.target_gname,file:args.image,extras:args.extras});};JMessage.prototype.sendSingleLocation=function(args){return this.__sendLocation({type:'single',target_id:args.target_username,target_name:args.target_nickname,latitude:args.latitude,longitude:args.longitude,scale:args.scale,label:args.label,extras:args.extras,appkey:args.appkey});};JMessage.prototype.sendGroupLocation=function(args){return this.__sendLocation({type:'group',target_id:args.target_gid,target_name:args.target_gname,latitude:args.latitude,longitude:args.longitude,scale:args.scale,label:args.label,extras:args.extras});};JMessage.prototype.sendSingleCustom=function(args){return this.__sendCustom({type:'single',target_id:args.target_username,target_name:args.target_nickname,custom:args.custom,appkey:args.appkey});};JMessage.prototype.sendGroupCustom=function(args){return this.__sendCustom({type:'group',target_id:args.target_gid,target_name:args.target_gname,custom:args.custom});};JMessage.prototype.createGroup=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.CREATE_GROUP).setData(args).send();};JMessage.prototype.exitGroup=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.EXIT_GROUP).setData(args).send();};JMessage.prototype.getGroups=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_GROUPS_LIST).setData({}).send();};JMessage.prototype.getGroupInfo=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_GROUP_INFO).setData(args).send();};JMessage.prototype.updateGroupInfo=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.UPDATE_GROUP_INFO).setData(args).send();};JMessage.prototype.getGroupMembers=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_GROUP_MEMBERS).setData(args).send();};JMessage.prototype.addGroupMembers=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_ACROSS_GROUP_MEMBER).setData(args).send();};JMessage.prototype.delGroupMembers=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DEL_ACROSS_GROUP_MEMBER).setData(args).send();};JMessage.prototype.getNoDisturb=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.NO_DISTURB).setData({version:0}).send();};JMessage.prototype.addSingleNoDisturb=function(args){this.__checkInit();args.version=0;return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_MSG_NO_DISTURB_SINGLE).setData(args).send();};JMessage.prototype.delSingleNoDisturb=function(args){this.__checkInit();args.version=0;return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DELETE_MSG_NO_DISTURB_SINGLE).setData(args).send();};JMessage.prototype.addGroupNoDisturb=function(args){this.__checkInit();args.version=0;return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_MSG_NO_DISTURB_GROUP).setData(args).send();};JMessage.prototype.delGroupNoDisturb=function(args){this.__checkInit();args.version=0;return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DELETE_MSG_NO_DISTURB_GROUP).setData(args).send();};JMessage.prototype.addGlobalNoDisturb=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_MSG_NO_DISTURB_GLOBAL).setData({version:0}).send();};JMessage.prototype.delGlobalNoDisturb=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DELETE_MSG_NO_DISTURB_GLOBAL).setData({version:0}).send();};JMessage.prototype.getBlacks=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_BLACK_LIST).setData({version:0}).send();};JMessage.prototype.addSingleBlacks=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_BLACK_LIST).setData(args).send();};JMessage.prototype.delSingleBlacks=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DEL_BLACK_LIST).setData(args).send();};JMessage.prototype.getFriendList=function(){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_FRIEND_LIST).setData({}).send();};JMessage.prototype.addFriend=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_FRIEND).setData(args).send();};JMessage.prototype.delFriend=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DEL_FRIEND).setData(args).send();};JMessage.prototype.updateFriendMemo=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.UPDATE_FRIEND_MEMO).setData(args).send();};JMessage.prototype.addGroupShield=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.ADD_MSG_SHIELD_GROUP).setData(args).send();};JMessage.prototype.delGroupShield=function(args){this.__checkInit();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.DEL_MSG_SHIELD_GROUP).setData(args).send();};JMessage.prototype.onMsgReceive=function(fn){var self=this;this.channel.client.on(JConstant.EVENTS.MSG_SYNC,function(data){self.opts.debug&&console.log('onMsgReceive -- %s',JSON.stringify(data));data.messages.forEach(function(item){var packDataItem={};packDataItem.target_type=item.content.target_type;packDataItem.target_name=item.content.target_name;packDataItem.target_id=item.content.target_id;packDataItem.from_name=item.content.from_name;packDataItem.from_id=item.content.from_id;packDataItem.from_platform=item.content.from_platform;packDataItem.create_time=item.ctime_ms;packDataItem.msg_type=item.content.msg_type;packDataItem.msg_body=item.content.msg_body;if(packDataItem.msg_body.isFileUploaded){delete packDataItem.msg_body.isFileUploaded;}
if(item.msg_level===0){packDataItem.msg_level='normal';}else if(item.msg_level===1){packDataItem.msg_level='across';packDataItem.target_appkey=item.content.target_appkey;packDataItem.from_appkey=item.content.from_appkey;}
Util.StorageUtils.addItem(item.msg_id,self.current_user);fn&&fn(data);});var msgRecv=[];Array.prototype.push.apply(msgRecv,data.messages.map(function(item){return{msg_id:item.msg_id,msg_type:item.msg_type,from_uid:item.from_uid,from_gid:item.from_gid};}));new MsgBuilder(self.channel).setEvent(JConstant.EVENTS.MSG_RECV).setData({messages:msgRecv}).send();});};JMessage.prototype.onEventNotification=function(fn){var self=this;this.channel.client.on(JConstant.EVENTS.EVENT_NOTIFICATION,function(data){self.opts.debug&&console.log('onEventNotification -- %s',JSON.stringify(data));var userData={};userData.event_type=data.event_type;userData.from_username=data.from_username;userData.gid=data.gid;userData.to_usernames=data.to_usernames;userData.extra=data.extra;userData.return_code=data.return_code;userData.description=data.description;userData.from_appkey=data.from_appkey;fn&&fn(userData);var eventRecv={"event_id":data.event_id,"event_type":data.event_type,"from_uid":data.from_uid,"gid":data.gid};new MsgBuilder(self.channel).setEvent(JConstant.EVENTS.EVENT_NOTIFICATION).setData(eventRecv).send();if(JConstant.LOGIN_OUT_EVENT.indexOf(data.event_type)!=-1){self.loginOut();}});};JMessage.prototype.onSyncConversation=function(fn){var self=this;this.channel.client.on(JConstant.EVENTS.SYNC_CONVERSATION,function(data){self.opts.debug&&console.log('onSyncMsg -- %s',JSON.stringify(data));self.channel.sync_key=data.sync_key;Util.StorageUtils.addItem(self.current_user+'s_key',data.sync_key);if(!data['syncInit']){var msgs=Util.StorageUtils.checkRepeatItems(data.messages,self.current_user);fn&&(msgs.length>0)&&fn(msgs);}
var syncAck={'sync_key':self.channel.sync_key};new MsgBuilder(self.channel).setEvent(JConstant.EVENTS.SYNC_CONVERSATION_ACK).setData(syncAck).send();Util.StorageUtils.removeItems(self.current_user);});};JMessage.prototype.onDisconnect=function(fn){var self=this;this.channel.client.on('disconnect',function(){if(self.autoDiscon){self.current_appkey=null;self.current_user=null;fn();}});};JMessage.prototype.__checkConnect=function(){if(!this.channel.client.connected){throw new Error('wss socket not connect')}};JMessage.prototype.__checkInit=function(){if(!this.current_appkey){throw new Error('必须执行init操作后能执行此动作')}};JMessage.prototype.__checkLogin=function(){if(!this.current_user){throw new Error('必须执行login操作后能执行此动作');}};JMessage.prototype.__getUploadToken=function(){this.__checkLogin();return new MsgBuilder(this.channel).setEvent(JConstant.EVENTS.GET_UPLOAD_TOKEN).setData({}).send();};JMessage.prototype.__uploadFile0=function(args,callback){wx.uploadFile({url:JConstant.UPLOAD_FILE+'?type='+args.type,filePath:args.file,name:'file',header:{'X-App-Key':args.appkey,'Authorization':'Basic '+Base64.btoa(args.username+':'+args.token)},success:function(res){var s=res;if(res.statusCode==200){callback(null,JSON.parse(res.data));}else{callback(JSON.parse(res.data));}},fail:function(res){var s=res;}})};JMessage.prototype.__uploadFile=function(args,callback){var self=this;self.__getUploadToken().onSuccess(function(data){self.__uploadFile0({type:args.type,file:args.file,appkey:args.appkey,username:args.username,token:data.uptoken},callback);}).onFail(function(data){callback({data:data});}).onTimeout(function(data){callback({is_timeout:true,data:data});});};JMessage.prototype.__sendMsg=function(args){this.__checkLogin();var self=this;return new MsgBuilder(this.channel).setEvent('single'===args.type?JConstant.EVENTS.S_SINGLE_TEXT:JConstant.EVENTS.SEND_GROUP_MSG).setData(new MsgContentBuilder(this.current_user,this.current_appkey).setType(args.type).setAppkey(args.appkey).setTarget(args.target_id,args.target_name).setText(args.content,args.extras).setAtList(args.at_list).build()).send().onInnerCall(function(msg_id){Util.StorageUtils.addItem(msg_id,self.current_user);});};JMessage.prototype.__sendPic=function(args){this.__checkLogin();var builder=new MsgBuilder(this.channel).setEvent('single'===args.type?JConstant.EVENTS.S_SINGLE_TEXT:JConstant.EVENTS.SEND_GROUP_MSG);var self=this;this.__uploadFile({appkey:self.current_appkey,username:self.current_user,file:args.file,type:'image'},function(err,content){if(err){if(err.is_timeout)return builder.timeout&&builder.timeout(err.data);;return builder.fail&&builder.fail(err.data);}
builder.setData(new MsgContentBuilder(self.current_user,self.current_appkey).setType(args.type).setAppkey(args.appkey).setTarget(args.target_id,args.target_name).setImage(content,args.extras).build()).send().onInnerCall(function(msg_id){Util.StorageUtils.addItem(msg_id,self.current_user);});});return builder;};JMessage.prototype.__sendFile=function(args){this.__checkLogin();var builder=new MsgBuilder(this.channel).setEvent('single'===args.type?JConstant.EVENTS.S_SINGLE_TEXT:JConstant.EVENTS.SEND_GROUP_MSG);var self=this;this.__uploadFile({appkey:self.current_appkey,username:self.current_user,file:args.file,type:'file'},function(err,content){if(err){if(err.is_timeout)return builder.timeout&&builder.timeout(err.data);return builder.fail&&builder.fail(err.data);}
builder.setData(new MsgContentBuilder(self.current_user,self.current_appkey).setType(args.type).setAppkey(args.appkey).setTarget(args.target_id,args.target_name).setFile(content,args.extras).build()).send().onInnerCall(function(msg_id){Util.StorageUtils.addItem(msg_id,self.current_user);});});return builder;};JMessage.prototype.__sendLocation=function(args){this.__checkLogin();var self=this;return new MsgBuilder(this.channel).setEvent('single'===args.type?JConstant.EVENTS.S_SINGLE_TEXT:JConstant.EVENTS.SEND_GROUP_MSG).setData(new MsgContentBuilder(this.current_user,this.current_appkey).setType(args.type).setAppkey(args.appkey).setTarget(args.target_id,args.target_name).setLocation(args,args.extras).build()).send().onInnerCall(function(msg_id){Util.StorageUtils.addItem(msg_id,self.current_user);});};JMessage.prototype.__sendCustom=function(args){var self=this;this.__checkLogin();return new MsgBuilder(this.channel).setEvent('single'===args.type?JConstant.EVENTS.S_SINGLE_TEXT:JConstant.EVENTS.SEND_GROUP_MSG).setData(new MsgContentBuilder(this.current_user,this.current_appkey).setType(args.type).setAppkey(args.appkey).setTarget(args.target_id,args.target_name).setCustom(args.custom).build()).send().onInnerCall(function(msg_id){Util.StorageUtils.addItem(msg_id,self.current_user);});};module.exports=JMessage;},function(module,exports,__webpack_require__){;(function(){var object=true?exports:self;var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';function InvalidCharacterError(message){this.message=message;}
InvalidCharacterError.prototype=new Error;InvalidCharacterError.prototype.name='InvalidCharacterError';object.btoa||(object.btoa=function(input){var str=String(input);for(var block,charCode,idx=0,map=chars,output='';str.charAt(idx|0)||(map='=',idx%1);output+=map.charAt(63&block>>8-idx%1*8)){charCode=str.charCodeAt(idx+=3/4);if(charCode>0xFF){throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");}
block=block<<8|charCode;}
return output;});object.atob||(object.atob=function(input){var str=String(input).replace(/=+$/,'');if(str.length%4==1){throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");}
for(var bc=0,bs,buffer,idx=0,output='';buffer=str.charAt(idx++);~buffer&&(bs=bc%4?bs*64+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0){buffer=chars.indexOf(buffer);}
return output;});}());},function(module,exports,__webpack_require__){var Emitter=__webpack_require__(5);var io=__webpack_require__(6);var JConstant=__webpack_require__(42);var Channel=function(opt){this.init(opt);};Channel.prototype.init=function(opts){this.opts=opts;this.dataCache={};this.memStore={};this.sync_key=0;this.sync_type=0;this.client=io(this.opts['address'],{'transports':['websocket','polling']});var self=this;var emit=Emitter.prototype.emit;var onevent=this.client.onevent;this.client.onevent=function(packet){var args=packet.data||[];onevent.call(self.client,packet);emit.apply(self.client,['*'].concat(args));};this.client.on('*',function(data,event){self.onReceive(data,event);});};Channel.prototype.onReceive=function(event,data){this.opts.debug&&console.log('onReceive -- event:%s, data:%s',event,JSON.stringify(data));if(event===JConstant.EVENTS.EVENT_NOTIFICATION||event===JConstant.EVENTS.MSG_SYNC||event===JConstant.EVENTS.SYNC_CONVERSATION){return;}
var msg=this.dataCache[data.rid];delete data['rid'];if(msg){if(event===JConstant.EVENTS.ACK){msg.ack&&msg.ack({rid:data.rid,data:msg.data});msg.cleanAckTimeout();}else{if(data.code&&data.code!==0){msg.fail&&msg.fail(data);}else if(event!=JConstant.EVENTS.S_SINGLE_TEXT_&&event!=JConstant.EVENTS.SEND_GROUP_MSG){msg.success&&msg.success(data);}else{msg.data.msg_id=data.msg_id;msg.success&&msg.success(data,msg.data);msg.innerCall&&msg.innerCall(data.msg_id);}
msg.cleanRespTimeout();delete this.dataCache[msg.rid];}}};Channel.prototype.generateRid=function(){var rid=Math.floor(Math.random()*(1-2147483647)+2147483647);while(this.dataCache[rid]){rid=Math.floor(Math.random()*(1-2147483647)+2147483647);}
return rid;};Channel.prototype.send=function(event,data){this.opts.debug&&console.log('send -- event:%s, data:%s',event,JSON.stringify(data));this.client.emit(event,data);};module.exports=Channel;},function(module,exports,__webpack_require__){if(true){module.exports=Emitter;}
function Emitter(obj){if(obj)return mixin(obj);};function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key];}
return obj;}
Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks['$'+event]=this._callbacks['$'+event]||[]).push(fn);return this;};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments);}
on.fn=fn;this.on(event,on);return this;};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this;}
var callbacks=this._callbacks['$'+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks['$'+event];return this;}
var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break;}}
return this;};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks['$'+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args);}}
return this;};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks['$'+event]||[];};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length;};},function(module,exports,__webpack_require__){var url=__webpack_require__(7);var parser=__webpack_require__(13);var Manager=__webpack_require__(18);var debug=__webpack_require__(9)('socket.io-client');module.exports=exports=lookup;var cache=exports.managers={};function lookup(uri,opts){if(typeof uri==='object'){opts=uri;uri=undefined;}
opts=opts||{};var parsed=url(uri);var source=parsed.source;var id=parsed.id;var path=parsed.path;var sameNamespace=cache[id]&&path in cache[id].nsps;var newConnection=opts.forceNew||opts['force new connection']||false===opts.multiplex||sameNamespace;var io;if(newConnection){debug('ignoring socket cache for %s',source);io=Manager(source,opts);}else{if(!cache[id]){debug('new io instance for %s',source);cache[id]=Manager(source,opts);}
io=cache[id];}
if(parsed.query&&!opts.query){opts.query=parsed.query;}else if(opts&&'object'===typeof opts.query){opts.query=encodeQueryString(opts.query);}
return io.socket(parsed.path,opts);}
function encodeQueryString(obj){var str=[];for(var p in obj){if(obj.hasOwnProperty(p)){str.push(encodeURIComponent(p)+'='+encodeURIComponent(obj[p]));}}
return str.join('&');}
exports.protocol=parser.protocol;exports.connect=lookup;exports.Manager=__webpack_require__(18);exports.Socket=__webpack_require__(37);},function(module,exports,__webpack_require__){var parseuri=__webpack_require__(8);var debug=__webpack_require__(9)('socket.io-client:url');module.exports=url;function url(uri,loc){var obj=uri;if(null==uri)uri=loc.protocol+'//'+loc.host;if('string'===typeof uri){if('/'===uri.charAt(0)){if('/'===uri.charAt(1)){uri=loc.protocol+uri;}else{uri=loc.host+uri;}}
if(!/^(https?|wss?):\/\//.test(uri)){debug('protocol-less url %s',uri);if('undefined'!==typeof loc){uri=loc.protocol+'//'+uri;}else{uri='https://'+uri;}}
debug('parse %s',uri);obj=parseuri(uri);}
if(!obj.port){if(/^(http|ws)$/.test(obj.protocol)){obj.port='80';}else if(/^(http|ws)s$/.test(obj.protocol)){obj.port='443';}}
obj.path=obj.path||'/';var ipv6=obj.host.indexOf(':')!==-1;var host=ipv6?'['+obj.host+']':obj.host;obj.id=obj.protocol+'://'+host+':'+obj.port;obj.href=obj.protocol+'://'+host+(loc&&loc.port===obj.port?'':(':'+obj.port));return obj;}},function(module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts=['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'];module.exports=function parseuri(str){var src=str,b=str.indexOf('['),e=str.indexOf(']');if(b!=-1&&e!=-1){str=str.substring(0,b)+str.substring(b,e).replace(/:/g,';')+str.substring(e,str.length);}
var m=re.exec(str||''),uri={},i=14;while(i--){uri[parts[i]]=m[i]||'';}
if(b!=-1&&e!=-1){uri.source=src;uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,':');uri.authority=uri.authority.replace('[','').replace(']','').replace(/;/g,':');uri.ipv6uri=true;}
return uri;};},function(module,exports,__webpack_require__){(function(process){exports=module.exports=__webpack_require__(11);exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=['lightseagreen','forestgreen','goldenrod','dodgerblue','darkorchid','crimson'];function useColors(){return(typeof document!=='undefined'&&'WebkitAppearance'in document.documentElement.style)||(window.console&&(console.firebug||(console.exception&&console.table)))||(navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31);}
exports.formatters.j=function(v){try{return JSON.stringify(v);}catch(err){return'[UnexpectedJSONParseError]: '+err.message;}};function formatArgs(){var args=arguments;var useColors=this.useColors;args[0]=(useColors?'%c':'')
+this.namespace
+(useColors?' %c':' ')
+args[0]
+(useColors?'%c ':' ')
+'+'+exports.humanize(this.diff);if(!useColors)return args;var c='color: '+this.color;args=[args[0],c,'color: inherit'].concat(Array.prototype.slice.call(args,1));var index=0;var lastC=0;args[0].replace(/%[a-z%]/g,function(match){if('%%'===match)return;index++;if('%c'===match){lastC=index;}});args.splice(lastC,0,c);return args;}
function log(){return'object'===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments);}
function save(namespaces){try{if(null==namespaces){exports.storage.removeItem('debug');}else{exports.storage.debug=namespaces;}}catch(e){}}
function load(){var r;try{return exports.storage.debug;}catch(e){}
if(typeof process!=='undefined'&&'env'in process){return process.env.DEBUG;}}
exports.enable(load());function localstorage(){try{return window.localStorage;}catch(e){}}}.call(exports,__webpack_require__(10)))},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error('setTimeout has not been defined');}
function defaultClearTimeout(){throw new Error('clearTimeout has not been defined');}
(function(){try{if(typeof setTimeout==='function'){cachedSetTimeout=setTimeout;}else{cachedSetTimeout=defaultSetTimout;}}catch(e){cachedSetTimeout=defaultSetTimout;}
try{if(typeof clearTimeout==='function'){cachedClearTimeout=clearTimeout;}else{cachedClearTimeout=defaultClearTimeout;}}catch(e){cachedClearTimeout=defaultClearTimeout;}}())
function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0);}
if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0);}
try{return cachedSetTimeout(fun,0);}catch(e){try{return cachedSetTimeout.call(null,fun,0);}catch(e){return cachedSetTimeout.call(this,fun,0);}}}
function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker);}
if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker);}
try{return cachedClearTimeout(marker);}catch(e){try{return cachedClearTimeout.call(null,marker);}catch(e){return cachedClearTimeout.call(this,marker);}}}
var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return;}
draining=false;if(currentQueue.length){queue=currentQueue.concat(queue);}else{queueIndex=-1;}
if(queue.length){drainQueue();}}
function drainQueue(){if(draining){return;}
var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run();}}
queueIndex=-1;len=queue.length;}
currentQueue=null;draining=false;runClearTimeout(timeout);}
process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i];}}
queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue);}};function Item(fun,array){this.fun=fun;this.array=array;}
Item.prototype.run=function(){this.fun.apply(null,this.array);};process.title='browser';process.browser=true;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}
process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error('process.binding is not supported');};process.cwd=function(){return'/'};process.chdir=function(dir){throw new Error('process.chdir is not supported');};process.umask=function(){return 0;};},function(module,exports,__webpack_require__){exports=module.exports=debug.debug=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=__webpack_require__(12);exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0;var prevTime;function selectColor(){return exports.colors[prevColor++%exports.colors.length];}
function debug(namespace){function disabled(){}
disabled.enabled=false;function enabled(){var self=enabled;var curr=+new Date();var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;if(null==self.useColors)self.useColors=exports.useColors();if(null==self.color&&self.useColors)self.color=selectColor();var args=new Array(arguments.length);for(var i=0;i<args.length;i++){args[i]=arguments[i];}
args[0]=exports.coerce(args[0]);if('string'!==typeof args[0]){args=['%o'].concat(args);}
var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if(match==='%%')return match;index++;var formatter=exports.formatters[format];if('function'===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--;}
return match;});args=exports.formatArgs.apply(self,args);var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args);}
enabled.enabled=true;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn;}
function enable(namespaces){exports.save(namespaces);var split=(namespaces||'').split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/[\\^$+?.()|[\]{}]/g,'\\$&').replace(/\*/g,'.*?');if(namespaces[0]==='-'){exports.skips.push(new RegExp('^'+namespaces.substr(1)+'$'));}else{exports.names.push(new RegExp('^'+namespaces+'$'));}}}
function disable(){exports.enable('');}
function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false;}}
for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true;}}
return false;}
function coerce(val){if(val instanceof Error)return val.stack||val.message;return val;}},function(module,exports){var s=1000
var m=s*60
var h=m*60
var d=h*24
var y=d*365.25
module.exports=function(val,options){options=options||{}
var type=typeof val
if(type==='string'&&val.length>0){return parse(val)}else if(type==='number'&&isNaN(val)===false){return options.long?fmtLong(val):fmtShort(val)}
throw new Error('val is not a non-empty string or a valid number. val='+JSON.stringify(val))}
function parse(str){str=String(str)
if(str.length>10000){return}
var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str)
if(!match){return}
var n=parseFloat(match[1])
var type=(match[2]||'ms').toLowerCase()
switch(type){case'years':case'year':case'yrs':case'yr':case'y':return n*y
case'days':case'day':case'd':return n*d
case'hours':case'hour':case'hrs':case'hr':case'h':return n*h
case'minutes':case'minute':case'mins':case'min':case'm':return n*m
case'seconds':case'second':case'secs':case'sec':case's':return n*s
case'milliseconds':case'millisecond':case'msecs':case'msec':case'ms':return n
default:return undefined}}
function fmtShort(ms){if(ms>=d){return Math.round(ms/d)+'d'}
if(ms>=h){return Math.round(ms/h)+'h'}
if(ms>=m){return Math.round(ms/m)+'m'}
if(ms>=s){return Math.round(ms/s)+'s'}
return ms+'ms'}
function fmtLong(ms){return plural(ms,d,'day')||plural(ms,h,'hour')||plural(ms,m,'minute')||plural(ms,s,'second')||ms+' ms'}
function plural(ms,n,name){if(ms<n){return}
if(ms<n*1.5){return Math.floor(ms/n)+' '+name}
return Math.ceil(ms/n)+' '+name+'s'}},function(module,exports,__webpack_require__){var debug=__webpack_require__(9)('socket.io-parser');var Emitter=__webpack_require__(14);var binary=__webpack_require__(15);var isBuf=__webpack_require__(17);exports.protocol=4;exports.types=['CONNECT','DISCONNECT','EVENT','ACK','ERROR','BINARY_EVENT','BINARY_ACK'];exports.CONNECT=0;exports.DISCONNECT=1;exports.EVENT=2;exports.ACK=3;exports.ERROR=4;exports.BINARY_EVENT=5;exports.BINARY_ACK=6;exports.Encoder=Encoder;exports.Decoder=Decoder;function Encoder(){}
Encoder.prototype.encode=function(obj,callback){debug('encoding packet %j',obj);if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){encodeAsBinary(obj,callback);}
else{var encoding=encodeAsString(obj);callback([encoding]);}};function encodeAsString(obj){var str='';var nsp=false;str+=obj.type;if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){str+=obj.attachments;str+='-';}
if(obj.nsp&&'/'!=obj.nsp){nsp=true;str+=obj.nsp;}
if(null!=obj.id){if(nsp){str+=',';nsp=false;}
str+=obj.id;}
if(null!=obj.data){if(nsp)str+=',';str+=JSON.stringify(obj.data);}
debug('encoded %j as %s',obj,str);return str;}
function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData);var pack=encodeAsString(deconstruction.packet);var buffers=deconstruction.buffers;buffers.unshift(pack);callback(buffers);}
binary.removeBlobs(obj,writeEncoding);}
function Decoder(){this.reconstructor=null;}
Emitter(Decoder.prototype);Decoder.prototype.add=function(obj){var packet;if('string'==typeof obj){packet=decodeString(obj);if(exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type){this.reconstructor=new BinaryReconstructor(packet);if(this.reconstructor.reconPack.attachments===0){this.emit('decoded',packet);}}else{this.emit('decoded',packet);}}
else if(isBuf(obj)||obj.base64){if(!this.reconstructor){throw new Error('got binary data when not reconstructing a packet');}else{packet=this.reconstructor.takeBinaryData(obj);if(packet){this.reconstructor=null;this.emit('decoded',packet);}}}
else{throw new Error('Unknown type: '+obj);}};function decodeString(str){var p={};var i=0;p.type=Number(str.charAt(0));if(null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){var buf='';while(str.charAt(++i)!='-'){buf+=str.charAt(i);if(i==str.length)break;}
if(buf!=Number(buf)||str.charAt(i)!='-'){throw new Error('Illegal attachments');}
p.attachments=Number(buf);}
if('/'==str.charAt(i+1)){p.nsp='';while(++i){var c=str.charAt(i);if(','==c)break;p.nsp+=c;if(i==str.length)break;}}else{p.nsp='/';}
var next=str.charAt(i+1);if(''!==next&&Number(next)==next){p.id='';while(++i){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break;}
p.id+=str.charAt(i);if(i==str.length)break;}
p.id=Number(p.id);}
if(str.charAt(++i)){p=tryParse(p,str.substr(i));}
debug('decoded %s as %j',str,p);return p;}
function tryParse(p,str){try{p.data=JSON.parse(str);}catch(e){return error();}
return p;};Decoder.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction();}};function BinaryReconstructor(packet){this.reconPack=packet;this.buffers=[];}
BinaryReconstructor.prototype.takeBinaryData=function(binData){this.buffers.push(binData);if(this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return packet;}
return null;};BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[];};function error(data){return{type:exports.ERROR,data:'parser error'};}},function(module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj);};function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key];}
return obj;}
Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);return this;};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments);}
on.fn=fn;this.on(event,on);return this;};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this;}
var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this;}
var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break;}}
return this;};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args);}}
return this;};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[];};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length;};},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(16);var isBuf=__webpack_require__(17);exports.deconstructPacket=function(packet){var buffers=[];var packetData=packet.data;function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:true,num:buffers.length};buffers.push(data);return placeholder;}else if(isArray(data)){var newData=new Array(data.length);for(var i=0;i<data.length;i++){newData[i]=_deconstructPacket(data[i]);}
return newData;}else if('object'==typeof data&&!(data instanceof Date)){var newData={};for(var key in data){newData[key]=_deconstructPacket(data[key]);}
return newData;}
return data;}
var pack=packet;pack.data=_deconstructPacket(packetData);pack.attachments=buffers.length;return{packet:pack,buffers:buffers};};exports.reconstructPacket=function(packet,buffers){var curPlaceHolder=0;function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf;}else if(isArray(data)){for(var i=0;i<data.length;i++){data[i]=_reconstructPacket(data[i]);}
return data;}else if(data&&'object'==typeof data){for(var key in data){data[key]=_reconstructPacket(data[key]);}
return data;}
return data;}
packet.data=_reconstructPacket(packet.data);packet.attachments=undefined;return packet;};exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if((global.Blob&&obj instanceof Blob)||(global.File&&obj instanceof File)){pendingBlobs++;var fileReader=new FileReader();fileReader.onload=function(){if(containingObject){containingObject[curKey]=this.result;}
else{bloblessData=this.result;}
if(!--pendingBlobs){callback(bloblessData);}};fileReader.readAsArrayBuffer(obj);}else if(isArray(obj)){for(var i=0;i<obj.length;i++){_removeBlobs(obj[i],i,obj);}}else if(obj&&'object'==typeof obj&&!isBuf(obj)){for(var key in obj){_removeBlobs(obj[key],key,obj);}}}
var pendingBlobs=0;var bloblessData=data;_removeBlobs(bloblessData);if(!pendingBlobs){callback(bloblessData);}};}.call(exports,(function(){return this;}())))},function(module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=='[object Array]';};},function(module,exports){(function(global){module.exports=isBuf;function isBuf(obj){return(Buffer&&Buffer.isBuffer(obj))||(ArrayBuffer&&obj instanceof ArrayBuffer);}}.call(exports,(function(){return this;}())))},function(module,exports,__webpack_require__){var eio=__webpack_require__(19);var Socket=__webpack_require__(37);var Emitter=__webpack_require__(5);var parser=__webpack_require__(13);var on=__webpack_require__(39);var bind=__webpack_require__(40);var debug=__webpack_require__(9)('socket.io-client:manager');var indexOf=__webpack_require__(35);var Backoff=__webpack_require__(41);var has=Object.prototype.hasOwnProperty;module.exports=Manager;function Manager(uri,opts){if(!(this instanceof Manager))return new Manager(uri,opts);if(uri&&('object'===typeof uri)){opts=uri;uri=undefined;}
opts=opts||{};opts.path=opts.path||'/socket.io';this.nsps={};this.subs=[];this.opts=opts;this.reconnection(opts.reconnection!==false);this.reconnectionAttempts(opts.reconnectionAttempts||Infinity);this.reconnectionDelay(opts.reconnectionDelay||1000);this.reconnectionDelayMax(opts.reconnectionDelayMax||5000);this.randomizationFactor(opts.randomizationFactor||0.5);this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==opts.timeout?20000:opts.timeout);this.readyState='closed';this.uri=uri;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];this.encoder=new parser.Encoder();this.decoder=new parser.Decoder();this.autoConnect=opts.autoConnect!==false;if(this.autoConnect)this.open();}
Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].emit.apply(this.nsps[nsp],arguments);}}};Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].id=this.engine.id;}}};Emitter(Manager.prototype);Manager.prototype.reconnection=function(v){if(!arguments.length)return this._reconnection;this._reconnection=!!v;return this;};Manager.prototype.reconnectionAttempts=function(v){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=v;return this;};Manager.prototype.reconnectionDelay=function(v){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=v;this.backoff&&this.backoff.setMin(v);return this;};Manager.prototype.randomizationFactor=function(v){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=v;this.backoff&&this.backoff.setJitter(v);return this;};Manager.prototype.reconnectionDelayMax=function(v){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=v;this.backoff&&this.backoff.setMax(v);return this;};Manager.prototype.timeout=function(v){if(!arguments.length)return this._timeout;this._timeout=v;return this;};Manager.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect();}};Manager.prototype.open=Manager.prototype.connect=function(fn,opts){debug('readyState %s',this.readyState);if(~this.readyState.indexOf('open'))return this;debug('opening %s',this.uri);this.engine=eio(this.uri,this.opts);var socket=this.engine;var self=this;this.readyState='opening';this.skipReconnect=false;var openSub=on(socket,'open',function(){self.onopen();fn&&fn();});var errorSub=on(socket,'error',function(data){debug('connect_error');self.cleanup();self.readyState='closed';self.emitAll('connect_error',data);if(fn){var err=new Error('Connection error');err.data=data;fn(err);}else{self.maybeReconnectOnOpen();}});if(false!==this._timeout){var timeout=this._timeout;debug('connect attempt will timeout after %d',timeout);var timer=setTimeout(function(){debug('connect attempt timed out after %d',timeout);openSub.destroy();socket.close();socket.emit('error','timeout');self.emitAll('connect_timeout',timeout);},timeout);this.subs.push({destroy:function(){clearTimeout(timer);}});}
this.subs.push(openSub);this.subs.push(errorSub);return this;};Manager.prototype.onopen=function(){debug('open');this.cleanup();this.readyState='open';this.emit('open');var socket=this.engine;this.subs.push(on(socket,'data',bind(this,'ondata')));this.subs.push(on(socket,'ping',bind(this,'onping')));this.subs.push(on(socket,'pong',bind(this,'onpong')));this.subs.push(on(socket,'error',bind(this,'onerror')));this.subs.push(on(socket,'close',bind(this,'onclose')));this.subs.push(on(this.decoder,'decoded',bind(this,'ondecoded')));};Manager.prototype.onping=function(){this.lastPing=new Date();this.emitAll('ping');};Manager.prototype.onpong=function(){this.emitAll('pong',new Date()-this.lastPing);};Manager.prototype.ondata=function(data){this.decoder.add(data);};Manager.prototype.ondecoded=function(packet){this.emit('packet',packet);};Manager.prototype.onerror=function(err){debug('error',err);this.emitAll('error',err);};Manager.prototype.socket=function(nsp,opts){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp,opts);this.nsps[nsp]=socket;var self=this;socket.on('connecting',onConnecting);socket.on('connect',function(){socket.id=self.engine.id;});if(this.autoConnect){onConnecting();}}
function onConnecting(){if(!~indexOf(self.connecting,socket)){self.connecting.push(socket);}}
return socket;};Manager.prototype.destroy=function(socket){var index=indexOf(this.connecting,socket);if(~index)this.connecting.splice(index,1);if(this.connecting.length)return;this.close();};Manager.prototype.packet=function(packet){debug('writing packet %j',packet);var self=this;if(packet.query&&packet.type===0)packet.nsp+='?'+packet.query;if(!self.encoding){self.encoding=true;this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++){self.engine.write(encodedPackets[i],packet.options);}
self.encoding=false;self.processPacketQueue();});}else{self.packetBuffer.push(packet);}};Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack);}};Manager.prototype.cleanup=function(){debug('cleanup');var subsLength=this.subs.length;for(var i=0;i<subsLength;i++){var sub=this.subs.shift();sub.destroy();}
this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy();};Manager.prototype.close=Manager.prototype.disconnect=function(){debug('disconnect');this.skipReconnect=true;this.reconnecting=false;if('opening'===this.readyState){this.cleanup();}
this.backoff.reset();this.readyState='closed';if(this.engine)this.engine.close();};Manager.prototype.onclose=function(reason){debug('onclose');this.cleanup();this.backoff.reset();this.readyState='closed';this.emit('close',reason);if(this._reconnection&&!this.skipReconnect){this.reconnect();}};Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts){debug('reconnect failed');this.backoff.reset();this.emitAll('reconnect_failed');this.reconnecting=false;}else{var delay=this.backoff.duration();debug('will wait %dms before reconnect attempt',delay);this.reconnecting=true;var timer=setTimeout(function(){if(self.skipReconnect)return;debug('attempting reconnect');self.emitAll('reconnect_attempt',self.backoff.attempts);self.emitAll('reconnecting',self.backoff.attempts);if(self.skipReconnect)return;self.open(function(err){if(err){debug('reconnect attempt error');self.reconnecting=false;self.reconnect();self.emitAll('reconnect_error',err.data);}else{debug('reconnect success');self.onreconnect();}});},delay);this.subs.push({destroy:function(){clearTimeout(timer);}});}};Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll('reconnect',attempt);};},function(module,exports,__webpack_require__){module.exports=__webpack_require__(20);module.exports.parser=__webpack_require__(23);},function(module,exports,__webpack_require__){var WS=__webpack_require__(21);var Emitter=__webpack_require__(5);var debug=__webpack_require__(9)('engine.io-client:socket');var index=__webpack_require__(35);var parser=__webpack_require__(23);var parseuri=__webpack_require__(8);var parsejson=__webpack_require__(36);var parseqs=__webpack_require__(32);module.exports=Socket;function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);opts=opts||{};if(uri&&'object'===typeof uri){opts=uri;uri=null;}
if(uri){uri=parseuri(uri);opts.hostname=uri.host;opts.secure=uri.protocol==='https'||uri.protocol==='wss';opts.port=uri.port;if(uri.query)opts.query=uri.query;}else if(opts.host){opts.hostname=parseuri(opts.host).host;}
this.secure=true;this.port="443";this.agent=opts.agent||false;this.hostname=opts.hostname;this.port=opts.port;this.query=opts.query||{};if('string'===typeof this.query)this.query=parseqs.decode(this.query);this.upgrade=false!==opts.upgrade;this.path=(opts.path||'/engine.io').replace(/\/$/,'')+'/';this.forceJSONP=!!opts.forceJSONP;this.jsonp=false!==opts.jsonp;this.forceBase64=!!opts.forceBase64;this.enablesXDR=!!opts.enablesXDR;this.timestampParam=opts.timestampParam||'t';this.timestampRequests=opts.timestampRequests;this.transports=opts.transports||['polling','websocket'];this.readyState='';this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=opts.policyPort||843;this.rememberUpgrade=opts.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades;this.perMessageDeflate=false!==opts.perMessageDeflate?(opts.perMessageDeflate||{}):false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024;}
this.pfx=opts.pfx||null;this.key=opts.key||null;this.passphrase=opts.passphrase||null;this.cert=opts.cert||null;this.ca=opts.ca||null;this.ciphers=opts.ciphers||null;this.rejectUnauthorized=opts.rejectUnauthorized===undefined?null:opts.rejectUnauthorized;this.forceNode=!!opts.forceNode;this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingIntervalTimer=null;this.pingTimeoutTimer=null;this.open();}
Socket.priorWebsocketSuccess=false;Emitter(Socket.prototype);Socket.protocol=parser.protocol;Socket.Socket=Socket;Socket.Transport=__webpack_require__(22);Socket.transports=__webpack_require__(21);Socket.parser=__webpack_require__(23);Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol;query.transport=name;if(this.id)query.sid=this.id;var transport=new WS({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return transport;};function clone(obj){var o={};for(var i in obj){if(obj.hasOwnProperty(i)){o[i]=obj[i];}}
return o;}
Socket.prototype.open=function(){var transport='websocket';this.readyState='opening';try{transport=this.createTransport(transport);}catch(e){this.transports.shift();this.open();return;}
transport.open();this.setTransport(transport);};Socket.prototype.setTransport=function(transport){debug('setting transport %s',transport.name);var self=this;if(this.transport){debug('clearing existing transport %s',this.transport.name);this.transport.removeAllListeners();}
this.transport=transport;transport.on('drain',function(){self.onDrain();}).on('packet',function(packet){self.onPacket(packet);}).on('error',function(e){self.onError(e);}).on('close',function(){self.onClose('transport close');});};Socket.prototype.probe=function(name){debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1});var failed=false;var self=this;Socket.priorWebsocketSuccess=false;function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary;}
if(failed)return;debug('probe transport "%s" opened',name);transport.send([{type:'ping',data:'probe'}]);transport.once('packet',function(msg){if(failed)return;if('pong'===msg.type&&'probe'===msg.data){debug('probe transport "%s" pong',name);self.upgrading=true;self.emit('upgrading',transport);if(!transport)return;Socket.priorWebsocketSuccess='websocket'===transport.name;debug('pausing current transport "%s"',self.transport.name);self.transport.pause(function(){if(failed)return;if('closed'===self.readyState)return;debug('changing transport and sending upgrade packet');cleanup();self.setTransport(transport);transport.send([{type:'upgrade'}]);self.emit('upgrade',transport);transport=null;self.upgrading=false;self.flush();});}else{debug('probe transport "%s" failed',name);var err=new Error('probe error');err.transport=transport.name;self.emit('upgradeError',err);}});}
function freezeTransport(){if(failed)return;failed=true;cleanup();transport.close();transport=null;}
function onerror(err){var error=new Error('probe error: '+err);error.transport=transport.name;freezeTransport();debug('probe transport "%s" failed because of error: %s',name,err);self.emit('upgradeError',error);}
function onTransportClose(){onerror('transport closed');}
function onclose(){onerror('socket closed');}
function onupgrade(to){if(transport&&to.name!==transport.name){debug('"%s" works - aborting "%s"',to.name,transport.name);freezeTransport();}}
function cleanup(){transport.removeListener('open',onTransportOpen);transport.removeListener('error',onerror);transport.removeListener('close',onTransportClose);self.removeListener('close',onclose);self.removeListener('upgrading',onupgrade);}
transport.once('open',onTransportOpen);transport.once('error',onerror);transport.once('close',onTransportClose);this.once('close',onclose);this.once('upgrading',onupgrade);transport.open();};Socket.prototype.onOpen=function(){this.readyState='open';Socket.priorWebsocketSuccess='websocket'===this.transport.name;this.emit('open');this.flush();if('open'===this.readyState&&this.upgrade&&this.transport.pause){debug('starting upgrade probes');for(var i=0,l=this.upgrades.length;i<l;i++){this.probe(this.upgrades[i]);}}};Socket.prototype.onPacket=function(packet){if('opening'===this.readyState||'open'===this.readyState||'closing'===this.readyState){debug('socket receive: type "%s", data "%s"',packet.type,packet.data);this.emit('packet',packet);this.emit('heartbeat');switch(packet.type){case'open':this.onHandshake(parsejson(packet.data));break;case'pong':this.setPing();this.emit('pong');break;case'error':var err=new Error('server error');err.code=packet.data;this.onError(err);break;case'message':this.emit('data',packet.data);this.emit('message',packet.data);break;}}else{debug('packet received with socket readyState "%s"',this.readyState);}};Socket.prototype.onHandshake=function(data){this.emit('handshake',data);this.id=data.sid;this.transport.query.sid=data.sid;this.upgrades=this.filterUpgrades(data.upgrades);this.pingInterval=data.pingInterval;this.pingTimeout=data.pingTimeout;this.onOpen();if('closed'===this.readyState)return;this.setPing();this.removeListener('heartbeat',this.onHeartbeat);this.on('heartbeat',this.onHeartbeat);};Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){if('closed'===self.readyState)return;self.onClose('ping timeout');},timeout||(self.pingInterval+self.pingTimeout));};Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer=setTimeout(function(){debug('writing ping packet - expecting pong within %sms',self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout);},self.pingInterval);};Socket.prototype.ping=function(){var self=this;this.sendPacket('ping',function(){self.emit('ping');});};Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit('drain');}else{this.flush();}};Socket.prototype.flush=function(){if('closed'!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){debug('flushing %d packets in socket',this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit('flush');}};Socket.prototype.write=Socket.prototype.send=function(msg,options,fn){this.sendPacket('message',msg,options,fn);return this;};Socket.prototype.sendPacket=function(type,data,options,fn){if('function'===typeof data){fn=data;data=undefined;}
if('function'===typeof options){fn=options;options=null;}
if('closing'===this.readyState||'closed'===this.readyState){return;}
options=options||{};options.compress=false!==options.compress;var packet={type:type,data:data,options:options};this.emit('packetCreate',packet);this.writeBuffer.push(packet);if(fn)this.once('flush',fn);this.flush();};Socket.prototype.close=function(){if('opening'===this.readyState||'open'===this.readyState){this.readyState='closing';var self=this;if(this.writeBuffer.length){this.once('drain',function(){if(this.upgrading){waitForUpgrade();}else{close();}});}else if(this.upgrading){waitForUpgrade();}else{close();}}
function close(){self.onClose('forced close');debug('socket closing - telling transport to close');self.transport.close();}
function cleanupAndClose(){self.removeListener('upgrade',cleanupAndClose);self.removeListener('upgradeError',cleanupAndClose);close();}
function waitForUpgrade(){self.once('upgrade',cleanupAndClose);self.once('upgradeError',cleanupAndClose);}
return this;};Socket.prototype.onError=function(err){debug('socket error %j',err);Socket.priorWebsocketSuccess=false;this.emit('error',err);this.onClose('transport error',err);};Socket.prototype.onClose=function(reason,desc){if('opening'===this.readyState||'open'===this.readyState||'closing'===this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners('close');this.transport.close();this.transport.removeAllListeners();this.readyState='closed';this.id=null;this.emit('close',reason,desc);self.writeBuffer=[];self.prevBufferLen=0;}};Socket.prototype.filterUpgrades=function(upgrades){var filteredUpgrades=[];for(var i=0,j=upgrades.length;i<j;i++){if(~index(this.transports,upgrades[i]))filteredUpgrades.push(upgrades[i]);}
return filteredUpgrades;};},function(module,exports,__webpack_require__){(function(global){var Transport=__webpack_require__(22);var parser=__webpack_require__(23);var parseqs=__webpack_require__(32);var inherit=__webpack_require__(33);var yeast=__webpack_require__(34);var debug=__webpack_require__(9)('engine.io-client:websocket');module.exports=WS;function WS(opts){var forceBase64=(opts&&opts.forceBase64);if(forceBase64){this.supportsBinary=false;}
this.perMessageDeflate=opts.perMessageDeflate;Transport.call(this,opts);}
inherit(WS,Transport);WS.prototype.name='wx';WS.prototype.supportsBinary=true;WS.prototype.doOpen=function(){if(!this.check()){return;}
var uri=this.uri();var protocols=void(0);var opts={agent:this.agent,perMessageDeflate:this.perMessageDeflate};opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){opts.headers=this.extraHeaders;}
if(this.localAddress){opts.localAddress=this.localAddress;}
this.isOk=false;this.ws=wx;this.ws.connectSocket({url:uri})
if(this.ws.binaryType===undefined){this.supportsBinary=false;}
if(this.ws.supports&&this.ws.supports.binary){this.supportsBinary=true;this.ws.binaryType='nodebuffer';}else{this.ws.binaryType='arraybuffer';}
this.addEventListeners();};WS.prototype.addEventListeners=function(){var self=this;this.ws.onSocketOpen(function(){self.onOpen();self.isOk=true;});this.ws.onSocketClose(function(){self.onClose();self.isOk=false;});this.ws.onSocketMessage(function(ev){self.onData(ev.data);});this.ws.onSocketError(function(e){self.onError('websocket error',e);});};WS.prototype.write=function(packets){var self=this;this.writable=false;var total=packets.length;for(var i=0,l=total;i<l;i++){(function(packet){parser.encodePacket(packet,self.supportsBinary,function(data){try{self.ws.sendSocketMessage({"data":data});}catch(e){debug('websocket closed before onclose event');}
--total||done();});})(packets[i]);}
function done(){self.emit('flush');setTimeout(function(){self.writable=true;self.emit('drain');},0);}};WS.prototype.onClose=function(){Transport.prototype.onClose.call(this);};WS.prototype.doClose=function(){if(typeof this.ws!=='undefined'){this.ws.closeSocket();}};WS.prototype.uri=function(){var query=this.query||{};var schema=this.secure?'wss':'ws';var port='';if(this.port&&(('wss'===schema&&Number(this.port)!==443)||('ws'===schema&&Number(this.port)!==80))){port=':'+this.port;}
if(this.timestampRequests){query[this.timestampParam]=yeast();}
if(!this.supportsBinary){query.b64=1;}
query=parseqs.encode(query);if(query.length){query='?'+query;}
var ipv6=this.hostname.indexOf(':')!==-1;return schema+'://'+(ipv6?'['+this.hostname+']':this.hostname)+port+this.path+query;};WS.prototype.check=function(){return!this.isOk;};}.call(exports,(function(){return this;}())))},function(module,exports,__webpack_require__){var parser=__webpack_require__(23);var Emitter=__webpack_require__(5);module.exports=Transport;function Transport(opts){this.path=opts.path;this.hostname=opts.hostname;this.port=opts.port;this.secure=opts.secure;this.query=opts.query;this.timestampParam=opts.timestampParam;this.timestampRequests=opts.timestampRequests;this.readyState='';this.agent=opts.agent||false;this.socket=opts.socket;this.enablesXDR=opts.enablesXDR;this.pfx=opts.pfx;this.key=opts.key;this.passphrase=opts.passphrase;this.cert=opts.cert;this.ca=opts.ca;this.ciphers=opts.ciphers;this.rejectUnauthorized=opts.rejectUnauthorized;this.forceNode=opts.forceNode;this.extraHeaders=opts.extraHeaders;this.localAddress=opts.localAddress;}
Emitter(Transport.prototype);Transport.prototype.onError=function(msg,desc){var err=new Error(msg);err.type='TransportError';err.description=desc;this.emit('error',err);return this;};Transport.prototype.open=function(){if('closed'===this.readyState||''===this.readyState){this.readyState='opening';this.doOpen();}
return this;};Transport.prototype.close=function(){if('opening'===this.readyState||'open'===this.readyState){this.doClose();this.onClose();}
return this;};Transport.prototype.send=function(packets){if('open'===this.readyState){this.write(packets);}else{throw new Error('Transport not open');}};Transport.prototype.onOpen=function(){this.readyState='open';this.writable=true;this.emit('open');};Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet);};Transport.prototype.onPacket=function(packet){this.emit('packet',packet);};Transport.prototype.onClose=function(){this.readyState='closed';this.emit('close');};},function(module,exports,__webpack_require__){(function(global){var keys=__webpack_require__(24);var hasBinary=__webpack_require__(25);var sliceBuffer=__webpack_require__(26);var after=__webpack_require__(27);var utf8=__webpack_require__(28);var base64encoder;if(global&&global.ArrayBuffer){base64encoder=__webpack_require__(30);}
var isAndroid=typeof navigator!=='undefined'&&/Android/i.test(navigator.userAgent);var isPhantomJS=typeof navigator!=='undefined'&&/PhantomJS/i.test(navigator.userAgent);var dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var packetslist=keys(packets);var err={type:'error',data:'parser error'};var Blob=__webpack_require__(31);exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){if('function'==typeof supportsBinary){callback=supportsBinary;supportsBinary=false;}
if('function'==typeof utf8encode){callback=utf8encode;utf8encode=null;}
var data=(packet.data===undefined)?undefined:packet.data.buffer||packet.data;if(ArrayBuffer&&data instanceof ArrayBuffer){return encodeArrayBuffer(packet,supportsBinary,callback);}else if(Blob&&data instanceof Blob){return encodeBlob(packet,supportsBinary,callback);}
if(data&&data.base64){return encodeBase64Object(packet,callback);}
var encoded=packets[packet.type];if(undefined!==packet.data){encoded+=utf8encode?utf8.encode(String(packet.data)):String(packet.data);}
return callback(''+encoded);};function encodeBase64Object(packet,callback){var message='b'+exports.packets[packet.type]+packet.data.data;return callback(message);}
function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback);}
var data=packet.data;var contentArray=new Uint8Array(data);var resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++){resultBuffer[i+1]=contentArray[i];}
return callback(resultBuffer.buffer);}
function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback);}
var fr=new FileReader();fr.onload=function(){packet.data=fr.result;exports.encodePacket(packet,supportsBinary,true,callback);};return fr.readAsArrayBuffer(packet.data);}
function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback);}
if(dontSendBlobs){return encodeBlobAsArrayBuffer(packet,supportsBinary,callback);}
var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob);}
exports.encodeBase64Packet=function(packet,callback){var message='b'+exports.packets[packet.type];if(Blob&&packet.data instanceof global.Blob){var fr=new FileReader();fr.onload=function(){var b64=fr.result.split(',')[1];callback(message+b64);};return fr.readAsDataURL(packet.data);}
var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data));}catch(e){var typed=new Uint8Array(packet.data);var basic=new Array(typed.length);for(var i=0;i<typed.length;i++){basic[i]=typed[i];}
b64data=String.fromCharCode.apply(null,basic);}
message+=global.btoa(b64data);return callback(message);};exports.decodePacket=function(data,binaryType,utf8decode){if(data===undefined){return err;}
if(typeof data=='string'){if(data.charAt(0)=='b'){return exports.decodeBase64Packet(data.substr(1),binaryType);}
if(utf8decode){data=tryDecode(data);if(data===false){return err;}}
var type=data.charAt(0);if(Number(type)!=type||!packetslist[type]){return err;}
if(data.length>1){return{type:packetslist[type],data:data.substring(1)};}else{return{type:packetslist[type]};}}
var asArray=new Uint8Array(data);var type=asArray[0];var rest=sliceBuffer(data,1);if(Blob&&binaryType==='blob'){rest=new Blob([rest]);}
return{type:packetslist[type],data:rest};};function tryDecode(data){try{data=utf8.decode(data);}catch(e){return false;}
return data;}
exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!base64encoder){return{type:type,data:{base64:true,data:msg.substr(1)}};}
var data=base64encoder.decode(msg.substr(1));if(binaryType==='blob'&&Blob){data=new Blob([data]);}
return{type:type,data:data};};exports.encodePayload=function(packets,supportsBinary,callback){if(typeof supportsBinary=='function'){callback=supportsBinary;supportsBinary=null;}
var isBinary=hasBinary(packets);if(supportsBinary&&isBinary){if(Blob&&!dontSendBlobs){return exports.encodePayloadAsBlob(packets,callback);}
return exports.encodePayloadAsArrayBuffer(packets,callback);}
if(!packets.length){return callback('0:');}
function setLengthHeader(message){return message.length+':'+message;}
function encodeOne(packet,doneCallback){exports.encodePacket(packet,!isBinary?false:supportsBinary,true,function(message){doneCallback(null,setLengthHeader(message));});}
map(packets,encodeOne,function(err,results){return callback(results.join(''));});};function map(ary,each,done){var result=new Array(ary.length);var next=after(ary.length,done);var eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg;cb(error,result);});};for(var i=0;i<ary.length;i++){eachWithIndex(i,ary[i],next);}}
exports.decodePayload=function(data,binaryType,callback){if(typeof data!='string'){return exports.decodePayloadAsBinary(data,binaryType,callback);}
if(typeof binaryType==='function'){callback=binaryType;binaryType=null;}
var packet;if(data==''){return callback(err,0,1);}
var length='',n,msg;for(var i=0,l=data.length;i<l;i++){var chr=data.charAt(i);if(':'!=chr){length+=chr;}else{if(''==length||(length!=(n=Number(length)))){return callback(err,0,1);}
msg=data.substr(i+1,n);if(length!=msg.length){return callback(err,0,1);}
if(msg.length){packet=exports.decodePacket(msg,binaryType,true);if(err.type==packet.type&&err.data==packet.data){return callback(err,0,1);}
var ret=callback(packet,i+n,l);if(false===ret)return;}
i+=n;length='';}}
if(length!=''){return callback(err,0,1);}};exports.encodePayloadAsArrayBuffer=function(packets,callback){if(!packets.length){return callback(new ArrayBuffer(0));}
function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(data){return doneCallback(null,data);});}
map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;if(typeof p==='string'){len=p.length;}else{len=p.byteLength;}
return acc+len.toString().length+len+2;},0);var resultArray=new Uint8Array(totalLength);var bufferIndex=0;encodedPackets.forEach(function(p){var isString=typeof p==='string';var ab=p;if(isString){var view=new Uint8Array(p.length);for(var i=0;i<p.length;i++){view[i]=p.charCodeAt(i);}
ab=view.buffer;}
if(isString){resultArray[bufferIndex++]=0;}else{resultArray[bufferIndex++]=1;}
var lenStr=ab.byteLength.toString();for(var i=0;i<lenStr.length;i++){resultArray[bufferIndex++]=parseInt(lenStr[i]);}
resultArray[bufferIndex++]=255;var view=new Uint8Array(ab);for(var i=0;i<view.length;i++){resultArray[bufferIndex++]=view[i];}});return callback(resultArray.buffer);});};exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(encoded){var binaryIdentifier=new Uint8Array(1);binaryIdentifier[0]=1;if(typeof encoded==='string'){var view=new Uint8Array(encoded.length);for(var i=0;i<encoded.length;i++){view[i]=encoded.charCodeAt(i);}
encoded=view.buffer;binaryIdentifier[0]=0;}
var len=(encoded instanceof ArrayBuffer)?encoded.byteLength:encoded.size;var lenStr=len.toString();var lengthAry=new Uint8Array(lenStr.length+1);for(var i=0;i<lenStr.length;i++){lengthAry[i]=parseInt(lenStr[i]);}
lengthAry[lenStr.length]=255;if(Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob);}});}
map(packets,encodeOne,function(err,results){return callback(new Blob(results));});};exports.decodePayloadAsBinary=function(data,binaryType,callback){if(typeof binaryType==='function'){callback=binaryType;binaryType=null;}
var bufferTail=data;var buffers=[];var numberTooLong=false;while(bufferTail.byteLength>0){var tailArray=new Uint8Array(bufferTail);var isString=tailArray[0]===0;var msgLength='';for(var i=1;;i++){if(tailArray[i]==255)break;if(msgLength.length>310){numberTooLong=true;break;}
msgLength+=tailArray[i];}
if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length);msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString){try{msg=String.fromCharCode.apply(null,new Uint8Array(msg));}catch(e){var typed=new Uint8Array(msg);msg='';for(var i=0;i<typed.length;i++){msg+=String.fromCharCode(typed[i]);}}}
buffers.push(msg);bufferTail=sliceBuffer(bufferTail,msgLength);}
var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,true),i,total);});};}.call(exports,(function(){return this;}())))},function(module,exports){module.exports=Object.keys||function keys(obj){var arr=[];var has=Object.prototype.hasOwnProperty;for(var i in obj){if(has.call(obj,i)){arr.push(i);}}
return arr;};},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(16);module.exports=hasBinary;function hasBinary(data){function _hasBinary(obj){if(!obj)return false;if((Buffer&&Buffer.isBuffer&&Buffer.isBuffer(obj))||(ArrayBuffer&&obj instanceof ArrayBuffer)||(Blob&&obj instanceof Blob)||(File&&obj instanceof File)){return true;}
if(isArray(obj)){for(var i=0;i<obj.length;i++){if(_hasBinary(obj[i])){return true;}}}else if(obj&&'object'==typeof obj){if(obj.toJSON&&'function'==typeof obj.toJSON){obj=obj.toJSON();}
for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)&&_hasBinary(obj[key])){return true;}}}
return false;}
return _hasBinary(data);}}.call(exports,(function(){return this;}())))},function(module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;start=start||0;end=end||bytes;if(arraybuffer.slice){return arraybuffer.slice(start,end);}
if(start<0){start+=bytes;}
if(end<0){end+=bytes;}
if(end>bytes){end=bytes;}
if(start>=bytes||start>=end||bytes===0){return new ArrayBuffer(0);}
var abv=new Uint8Array(arraybuffer);var result=new Uint8Array(end-start);for(var i=start,ii=0;i<end;i++,ii++){result[ii]=abv[i];}
return result.buffer;};},function(module,exports){module.exports=after
function after(count,callback,err_cb){var bail=false
err_cb=err_cb||noop
proxy.count=count
return(count===0)?callback():proxy
function proxy(err,result){if(proxy.count<=0){throw new Error('after called too many times')}
--proxy.count
if(err){bail=true
callback(err)
callback=err_cb}else if(proxy.count===0&&!bail){callback(null,result)}}}
function noop(){}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(module,global){;(function(root){var freeExports=typeof exports=='object'&&exports;var freeModule=typeof module=='object'&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=='object'&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal;}
var stringFromCharCode=String.fromCharCode;function ucs2decode(string){var output=[];var counter=0;var length=string.length;var value;var extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=0xD800&&value<=0xDBFF&&counter<length){extra=string.charCodeAt(counter++);if((extra&0xFC00)==0xDC00){output.push(((value&0x3FF)<<10)+(extra&0x3FF)+0x10000);}else{output.push(value);counter--;}}else{output.push(value);}}
return output;}
function ucs2encode(array){var length=array.length;var index=-1;var value;var output='';while(++index<length){value=array[index];if(value>0xFFFF){value-=0x10000;output+=stringFromCharCode(value>>>10&0x3FF|0xD800);value=0xDC00|value&0x3FF;}
output+=stringFromCharCode(value);}
return output;}
function createByte(codePoint,shift){return stringFromCharCode(((codePoint>>shift)&0x3F)|0x80);}
function encodeCodePoint(codePoint){if((codePoint&0xFFFFFF80)==0){return stringFromCharCode(codePoint);}
var symbol='';if((codePoint&0xFFFFF800)==0){symbol=stringFromCharCode(((codePoint>>6)&0x1F)|0xC0);}
else if((codePoint&0xFFFF0000)==0){symbol=stringFromCharCode(((codePoint>>12)&0x0F)|0xE0);symbol+=createByte(codePoint,6);}
else if((codePoint&0xFFE00000)==0){symbol=stringFromCharCode(((codePoint>>18)&0x07)|0xF0);symbol+=createByte(codePoint,12);symbol+=createByte(codePoint,6);}
symbol+=stringFromCharCode((codePoint&0x3F)|0x80);return symbol;}
function wtf8encode(string){var codePoints=ucs2decode(string);var length=codePoints.length;var index=-1;var codePoint;var byteString='';while(++index<length){codePoint=codePoints[index];byteString+=encodeCodePoint(codePoint);}
return byteString;}
function readContinuationByte(){if(byteIndex>=byteCount){throw Error('Invalid byte index');}
var continuationByte=byteArray[byteIndex]&0xFF;byteIndex++;if((continuationByte&0xC0)==0x80){return continuationByte&0x3F;}
throw Error('Invalid continuation byte');}
function decodeSymbol(){var byte1;var byte2;var byte3;var byte4;var codePoint;if(byteIndex>byteCount){throw Error('Invalid byte index');}
if(byteIndex==byteCount){return false;}
byte1=byteArray[byteIndex]&0xFF;byteIndex++;if((byte1&0x80)==0){return byte1;}
if((byte1&0xE0)==0xC0){var byte2=readContinuationByte();codePoint=((byte1&0x1F)<<6)|byte2;if(codePoint>=0x80){return codePoint;}else{throw Error('Invalid continuation byte');}}
if((byte1&0xF0)==0xE0){byte2=readContinuationByte();byte3=readContinuationByte();codePoint=((byte1&0x0F)<<12)|(byte2<<6)|byte3;if(codePoint>=0x0800){return codePoint;}else{throw Error('Invalid continuation byte');}}
if((byte1&0xF8)==0xF0){byte2=readContinuationByte();byte3=readContinuationByte();byte4=readContinuationByte();codePoint=((byte1&0x0F)<<0x12)|(byte2<<0x0C)|(byte3<<0x06)|byte4;if(codePoint>=0x010000&&codePoint<=0x10FFFF){return codePoint;}}
throw Error('Invalid WTF-8 detected');}
var byteArray;var byteCount;var byteIndex;function wtf8decode(byteString){byteArray=ucs2decode(byteString);byteCount=byteArray.length;byteIndex=0;var codePoints=[];var tmp;while((tmp=decodeSymbol())!==false){codePoints.push(tmp);}
return ucs2encode(codePoints);}
var wtf8={'version':'1.0.0','encode':wtf8encode,'decode':wtf8decode};if(true){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return wtf8;}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));}else if(freeExports&&!freeExports.nodeType){if(freeModule){freeModule.exports=wtf8;}else{var object={};var hasOwnProperty=object.hasOwnProperty;for(var key in wtf8){hasOwnProperty.call(wtf8,key)&&(freeExports[key]=wtf8[key]);}}}else{root.wtf8=wtf8;}}(this));}.call(exports,__webpack_require__(29)(module),(function(){return this;}())))},function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];module.children=[];module.webpackPolyfill=1;}
return module;}},function(module,exports){(function(){"use strict";var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var lookup=new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i;}
exports.encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),i,len=bytes.length,base64="";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[((bytes[i]&3)<<4)|(bytes[i+1]>>4)];base64+=chars[((bytes[i+1]&15)<<2)|(bytes[i+2]>>6)];base64+=chars[bytes[i+2]&63];}
if((len%3)===2){base64=base64.substring(0,base64.length-1)+"=";}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"==";}
return base64;};exports.decode=function(base64){var bufferLength=base64.length*0.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){bufferLength--;if(base64[base64.length-2]==="="){bufferLength--;}}
var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4){encoded1=lookup[base64.charCodeAt(i)];encoded2=lookup[base64.charCodeAt(i+1)];encoded3=lookup[base64.charCodeAt(i+2)];encoded4=lookup[base64.charCodeAt(i+3)];bytes[p++]=(encoded1<<2)|(encoded2>>4);bytes[p++]=((encoded2&15)<<4)|(encoded3>>2);bytes[p++]=((encoded3&3)<<6)|(encoded4&63);}
return arraybuffer;};})();},function(module,exports){(function(global){var BlobBuilder=Blob;var blobSupported=(function(){try{var a=new Blob(['hi']);return a.size===2;}catch(e){return false;}})();var blobSupportsArrayBufferView=blobSupported&&(function(){try{var b=new Blob([new Uint8Array([1,2])]);return b.size===2;}catch(e){return false;}})();var blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;function mapArrayBufferViews(ary){for(var i=0;i<ary.length;i++){var chunk=ary[i];if(chunk.buffer instanceof ArrayBuffer){var buf=chunk.buffer;if(chunk.byteLength!==buf.byteLength){var copy=new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf,chunk.byteOffset,chunk.byteLength));buf=copy.buffer;}
ary[i]=buf;}}}
function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder();mapArrayBufferViews(ary);for(var i=0;i<ary.length;i++){bb.append(ary[i]);}
return(options.type)?bb.getBlob(options.type):bb.getBlob();};function BlobConstructor(ary,options){mapArrayBufferViews(ary);return new Blob(ary,options||{});};module.exports=(function(){if(blobSupported){return blobSupportsArrayBufferView?Blob:BlobConstructor;}else if(blobBuilderSupported){return BlobBuilderConstructor;}else{return undefined;}})();}.call(exports,(function(){return this;}())))},function(module,exports){exports.encode=function(obj){var str='';for(var i in obj){if(obj.hasOwnProperty(i)){if(str.length)str+='&';str+=encodeURIComponent(i)+'='+encodeURIComponent(obj[i]);}}
return str;};exports.decode=function(qs){var qry={};var pairs=qs.split('&');for(var i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split('=');qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]);}
return qry;};},function(module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype;a.prototype=new fn;a.prototype.constructor=a;};},function(module,exports){'use strict';var alphabet='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''),length=64,map={},seed=0,i=0,prev;function encode(num){var encoded='';do{encoded=alphabet[num%length]+encoded;num=Math.floor(num/length);}while(num>0);return encoded;}
function decode(str){var decoded=0;for(i=0;i<str.length;i++){decoded=decoded*length+map[str.charAt(i)];}
return decoded;}
function yeast(){var now=encode(+new Date());if(now!==prev)return seed=0,prev=now;return now+'.'+encode(seed++);}
for(;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode;yeast.decode=decode;module.exports=yeast;},function(module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i;}
return-1;};},function(module,exports){var rvalidchars=/^[\],:{}\s]*$/;var rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g;var rtrimLeft=/^\s+/;var rtrimRight=/\s+$/;module.exports=function parsejson(data){if('string'!=typeof data||!data){return null;}
data=data.replace(rtrimLeft,'').replace(rtrimRight,'');return JSON.parse(data);};},function(module,exports,__webpack_require__){var parser=__webpack_require__(13);var Emitter=__webpack_require__(5);var toArray=__webpack_require__(38);var on=__webpack_require__(39);var bind=__webpack_require__(40);var debug=__webpack_require__(9)('socket.io-client:socket');var hasBin=__webpack_require__(25);module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var emit=Emitter.prototype.emit;function Socket(io,nsp,opts){this.io=io;this.nsp=nsp;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;if(opts&&opts.query){this.query=opts.query;}
if(this.io.autoConnect)this.open();}
Emitter(Socket.prototype);Socket.prototype.subEvents=function(){if(this.subs)return;var io=this.io;this.subs=[on(io,'open',bind(this,'onopen')),on(io,'packet',bind(this,'onpacket')),on(io,'close',bind(this,'onclose'))];};Socket.prototype.open=Socket.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if('open'===this.io.readyState)this.onopen();this.emit('connecting');return this;};Socket.prototype.send=function(){var args=toArray(arguments);args.unshift('message');this.emit.apply(this,args);return this;};Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev)){emit.apply(this,arguments);return this;}
var args=toArray(arguments);var parserType=parser.EVENT;var packet={type:parserType,data:args};packet.options={};packet.options.compress=!this.flags||false!==this.flags.compress;if('function'===typeof args[args.length-1]){debug('emitting packet with ack id %d',this.ids);this.acks[this.ids]=args.pop();packet.id=this.ids++;}
if(this.connected){this.packet(packet);}else{this.sendBuffer.push(packet);}
delete this.flags;return this;};Socket.prototype.packet=function(packet){packet.nsp=this.nsp;this.io.packet(packet);};Socket.prototype.onopen=function(){debug('transport is open - connecting');if('/'!==this.nsp){if(this.query){this.packet({type:parser.CONNECT,query:this.query});}else{this.packet({type:parser.CONNECT});}}};Socket.prototype.onclose=function(reason){debug('close (%s)',reason);this.connected=false;this.disconnected=true;delete this.id;this.emit('disconnect',reason);};Socket.prototype.onpacket=function(packet){if(packet.nsp!==this.nsp)return;switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit('error',packet.data);break;}};Socket.prototype.onevent=function(packet){var args=packet.data||[];debug('emitting event %j',args);if(null!=packet.id){debug('attaching ack callback to event');args.push(this.ack(packet.id));}
if(this.connected){emit.apply(this,args);}else{this.receiveBuffer.push(args);}};Socket.prototype.ack=function(id){var self=this;var sent=false;return function(){if(sent)return;sent=true;var args=toArray(arguments);debug('sending ack %j',args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args});};};Socket.prototype.onack=function(packet){var ack=this.acks[packet.id];if('function'===typeof ack){debug('calling ack %s with %j',packet.id,packet.data);ack.apply(this,packet.data);delete this.acks[packet.id];}else{debug('bad ack %s',packet.id);}};Socket.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit('connect');this.emitBuffered();};Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++){emit.apply(this,this.receiveBuffer[i]);}
this.receiveBuffer=[];for(i=0;i<this.sendBuffer.length;i++){this.packet(this.sendBuffer[i]);}
this.sendBuffer=[];};Socket.prototype.ondisconnect=function(){debug('server disconnect (%s)',this.nsp);this.destroy();this.onclose('io server disconnect');};Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++){this.subs[i].destroy();}
this.subs=null;}
this.io.destroy(this);};Socket.prototype.close=Socket.prototype.disconnect=function(){if(this.connected){debug('performing disconnect (%s)',this.nsp);this.packet({type:parser.DISCONNECT});}
this.destroy();if(this.connected){this.onclose('io client disconnect');}
return this;};Socket.prototype.compress=function(compress){this.flags=this.flags||{};this.flags.compress=compress;return this;};},function(module,exports){module.exports=toArray
function toArray(list,index){var array=[]
index=index||0
for(var i=index||0;i<list.length;i++){array[i-index]=list[i]}
return array}},function(module,exports){module.exports=on;function on(obj,ev,fn){obj.on(ev,fn);return{destroy:function(){obj.removeListener(ev,fn);}};}},function(module,exports){var slice=[].slice;module.exports=function(obj,fn){if('string'==typeof fn)fn=obj[fn];if('function'!=typeof fn)throw new Error('bind() requires a function');var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)));}};},function(module,exports){module.exports=Backoff;function Backoff(opts){opts=opts||{};this.ms=opts.min||100;this.max=opts.max||10000;this.factor=opts.factor||2;this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0;this.attempts=0;}
Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random();var deviation=Math.floor(rand*this.jitter*ms);ms=(Math.floor(rand*10)&1)==0?ms-deviation:ms+deviation;}
return Math.min(ms,this.max)|0;};Backoff.prototype.reset=function(){this.attempts=0;};Backoff.prototype.setMin=function(min){this.ms=min;};Backoff.prototype.setMax=function(max){this.max=max;};Backoff.prototype.setJitter=function(jitter){this.jitter=jitter;};},function(module,exports){var JConstant={SDK_VERSION:'2.2.0',WSS_ADDRESS:'wss://ws.im.jiguang.cn',UPLOAD_FILE:'https://sdk.im.jiguang.cn/resource',ALLOW_MSG_TYPE:['text','image','file','location','custom'],LOGIN_OUT_EVENT:[1,2],ACK_TIMEOUT:5000,RESP_TIMEOUT:30000,RETRY_TIMES:5,SYNC_INTERVAL:60000,SYNC_TYPE_OPEN:1,SYNC_TYPE_CLOSE:0,EVENTS:{ACK:'ack',INIT:'c_init',LOGIN:'login',REGISTER:'register',GET_USER_INFO:'get_across_user_info',GET_ACROSS_USER_INFO:'get_across_user_info',S_SINGLE_TEXT:'s_across_single_text',S_SINGLE_TEXT_:'s_single_text',MSG_SYNC:'msg_sync',MSG_RECV:'msg_recv',SEND_GROUP_MSG:'send_group_msg',CREATE_GROUP:'create_group',GET_GROUPS_LIST:'get_groups_list',GET_GROUP_INFO:'get_group_info',ADD_GROUP_MEMBER:'add_group_member',ADD_ACROSS_GROUP_MEMBER:'add_across_group_member',DEL_GROUP_MEMBER:'del_group_member',DEL_ACROSS_GROUP_MEMBER:'del_across_group_member',GET_GROUP_MEMBERS:'get_group_members',UPDATE_GROUP_INFO:'update_group_info',EXIT_GROUP:'exit_group',EVENT_NOTIFICATION:'event_notification',GET_CONVERSATIONS:'get_conversations',GET_UPLOAD_TOKEN:'get_upload_token',NO_DISTURB:'no_disturb',ADD_MSG_NO_DISTURB_SINGLE:'add_msg_no_disturb_single',DELETE_MSG_NO_DISTURB_SINGLE:'delete_msg_no_disturb_single',ADD_MSG_NO_DISTURB_GROUP:'add_msg_no_disturb_group',DELETE_MSG_NO_DISTURB_GROUP:'delete_msg_no_disturb_group',ADD_MSG_NO_DISTURB_GLOBAL:'add_msg_no_disturb_global',DELETE_MSG_NO_DISTURB_GLOBAL:'delete_msg_no_disturb_global',DISCONNECT:'disconnect',GET_BLACK_LIST:'get_black_list',ADD_BLACK_LIST:'add_black_list',DEL_BLACK_LIST:'del_black_list',UPDATE_SELF_INFO:'update_user_inf',UPDATE_SELF_PWD:'update_user_pwd',ADD_MSG_SHIELD_GROUP:'add_msg_shield_group',DEL_MSG_SHIELD_GROUP:'del_msg_shield_group',ADD_FRIEND:'add_friend',DEL_FRIEND:'del_friend',UPDATE_FRIEND_MEMO:'update_friend_memo',GET_FRIEND_LIST:'get_friend_list',SYNC_CHECK:'sync_check',SYNC_CONVERSATION:'sync_conversation',SYNC_CONVERSATION_ACK:'sync_conversation_ack',GET_RESOURCE:'get_resource'}};module.exports=JConstant;},function(module,exports,__webpack_require__){var JConstant=__webpack_require__(42);var MsgBuilder=function(channel){this.channel=channel;this.rid=this.channel.generateRid();this.times=1;};MsgBuilder.prototype.setEvent=function(event){this.event=event;return this;};MsgBuilder.prototype.setData=function(data){this.data=data;return this;};MsgBuilder.prototype.onSuccess=function(success){if(typeof success==='function'){this.success=success;}
return this;};MsgBuilder.prototype.onFail=function(fail){if(typeof fail==='function'){this.fail=fail;}
return this;};MsgBuilder.prototype.onTimeout=function(timeout){if(typeof timeout==='function'){this.timeout=timeout;var self=this;this.respTimeoutTaskId=setTimeout(function(){self.respTimeoutTask()},JConstant.RESP_TIMEOUT);}
return this;};MsgBuilder.prototype.onAck=function(ack){if(typeof ack==='function'){this.ack=ack;}
return this;};MsgBuilder.prototype.onInnerCall=function(innerCall){if(typeof innerCall==='function'){this.innerCall=innerCall;}
return this;};MsgBuilder.prototype.ackTimeoutTask=function(){if(this.times<JConstant.RETRY_TIMES){this.channel.send(this.event,this._data);this.times++;var self=this;this.ackTimeoutTaskId=setTimeout(function(){self.ackTimeoutTask();},JConstant.ACK_TIMEOUT);}else{this.timeout&&this.timeout({rid:this.rid,data:this.data,response_timeout:false});delete this.channel.dataCache[this.rid];}
return this;};MsgBuilder.prototype.respTimeoutTask=function(){if(this.times<JConstant.RETRY_TIMES){this.channel.send(this.event,this._data);this.times++;var self=this;this.respTimeoutTaskId=setTimeout(function(){self.respTimeoutTask()},JConstant.RESP_TIMEOUT);}else{this.timeout&&this.timeout({rid:this.rid,data:this.data,response_timeout:true});delete this.channel.dataCache[this.rid];}
return this;};MsgBuilder.prototype.cleanAckTimeout=function(){this.ackTimeoutTaskId&&clearTimeout(this.ackTimeoutTaskId);return this;};MsgBuilder.prototype.cleanRespTimeout=function(){this.respTimeoutTaskId&&clearTimeout(this.respTimeoutTaskId);return this;};MsgBuilder.prototype.send=function(){if(!this.event||!this.data){console.error('发送消息失败，event与data不能为空');return;}
var self=this;this.ackTimeoutTaskId=setTimeout(function(){self.ackTimeoutTask();},JConstant.ACK_TIMEOUT);this._data=(JSON.parse(JSON.stringify(this.data)));this._data['rid']=this.rid;this.channel.send(this.event,this._data);this.channel.dataCache[this.rid]=this;return this;};module.exports=MsgBuilder;},function(module,exports){var MsgContentBuilder=function(current_user,current_appkey){this.current_user=current_user;this.current_appkey=current_appkey;this.version=1;this.from_platform='web';};MsgContentBuilder.prototype.setType=function(type){this.type=type;return this;};MsgContentBuilder.prototype.setAtList=function(at_list){this.at_list=at_list;return this;};MsgContentBuilder.prototype.setAppkey=function(appkey){if(appkey)this.appkey=appkey;return this;};MsgContentBuilder.prototype.setTarget=function(target,target_name){this.target_id=target.toString();this.target_name=target_name;return this;};MsgContentBuilder.prototype.setFromName=function(from_name){this.from_name=from_name;return this;};MsgContentBuilder.prototype.setText=function(content,extras){this.msg_type='text';this.msg_body={'text':content};if(extras)this.msg_body['extras']=extras;return this;};MsgContentBuilder.prototype.setImage=function(imgObj,extras){this.msg_type='image';this.msg_body={'media_id':imgObj.media_id,'media_crc32':imgObj.media_crc32,'width':imgObj.width,'height':imgObj.height,'format':imgObj.format,'fsize':imgObj.fsize};if(extras)this.msg_body['extras']=extras;return this;};MsgContentBuilder.prototype.setFile=function(file,extras){this.msg_type='file';this.msg_body={'media_id':file.media_id,'media_crc32':file.media_crc32,'hash':file.hash,'fsize':file.fsize,'fname':file.fname};if(extras)this.msg_body['extras']=extras;return this;};MsgContentBuilder.prototype.setLocation=function(location,extras){this.msg_type='location';this.msg_body={'latitude':location.latitude,'longitude':location.longitude,'scale':location.scale,'label':location.label};if(extras)this.msg_body['extras']=extras;return this;};MsgContentBuilder.prototype.setCustom=function(custom){this.msg_type='custom';this.msg_body=custom;return this;};MsgContentBuilder.prototype.build=function(){var username=this.current_user;if(!username)return console.error('必须执行login操作后能执行此动作');if(this.type!='single'&&this.type!='group'&&this.type!='across_single')return console.log('消息类型必须是single或group');if(!this.target_id)return console.error('target_id不能为空');if(this.msg_type=='text'){if(!this.msg_body['text']&&this.at_list&&this.type!='single'){this.msg_body['text']=' ';}else if(!this.msg_body['text']&&!this.at_list){return console.error('未设置文本消息内容');}}else if(this.msg_type=='custom'){if(!this.msg_body)return console.error('custom对象不能为空');}else if(this.msg_type=='image'){if(!this.msg_body['media_id'])return console.error('未设置image消息media_id字段');if(!this.msg_body['media_crc32'])return console.error('未设置image消息media_crc32字段');if(!this.msg_body['width'])return console.error('未设置image消息width字段');if(!this.msg_body['height'])return console.error('未设置image消息height字段');}else if(this.msg_type=='file'){if(!this.msg_body['media_id'])return console.error('未设置file消息media_id字段');if(!this.msg_body['media_crc32'])return console.error('未设置file消息media_crc32字段');if(!this.msg_body['fsize'])return console.error('未设置file消息fsize字段');if(!this.msg_body['fname'])return console.error('未设置file消息fname字段');}else if(this.msg_type=='location'){if(!this.msg_body['latitude'])return console.error('未设置location消息latitude字段');if(!this.msg_body['longitude'])return console.error('未设置location消息longitude字段');if(!this.msg_body['scale'])return console.error('未设置location消息scale字段');if(!this.msg_body['label'])return console.error('未设置location消息label字段');}else{return console.error('请设置合法的msg_type');}
var content={'version':this.version,'target_type':this.type,'from_platform':this.from_platform,'target_id':this.target_id,'target_name':this.target_name,'from_id':username,'from_name':this.from_name,'create_time':new Date().getTime(),'msg_type':this.msg_type,'msg_body':this.msg_body};if(this.appkey){content['target_appkey']=this.appkey;content['from_appkey']=this.current_appkey;}
var payload={'content':content};if('single'==content.target_type){payload['target_name']=content.target_id;}else{payload['target_gid']=content.target_id;if(this.at_list&&(this.at_list instanceof Array)){payload['users']=this.at_list;}else if(this.at_list&&!(this.at_list instanceof Array)){return console.error('参数值不合法，at_list必须为数组类型');}}
if(this.appkey){payload['appkey']=this.appkey;}else{payload['appkey']=this.current_appkey;}
return payload;};module.exports=MsgContentBuilder;},function(module,exports){"use strict";module.exports=function(){function safe_add(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF)
var msw=(x>>16)+(y>>16)+(lsw>>16)
return(msw<<16)|(lsw&0xFFFF)}
function bit_rol(num,cnt){return(num<<cnt)|(num>>>(32-cnt))}
function md5_cmn(q,a,b,x,s,t){return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}
function md5_ff(a,b,c,d,x,s,t){return md5_cmn((b&c)|((~b)&d),a,b,x,s,t)}
function md5_gg(a,b,c,d,x,s,t){return md5_cmn((b&d)|(c&(~d)),a,b,x,s,t)}
function md5_hh(a,b,c,d,x,s,t){return md5_cmn(b^c^d,a,b,x,s,t)}
function md5_ii(a,b,c,d,x,s,t){return md5_cmn(c^(b|(~d)),a,b,x,s,t)}
function binl_md5(x,len){x[len>>5]|=0x80<<(len%32)
x[(((len+64)>>>9)<<4)+14]=len
var i
var olda
var oldb
var oldc
var oldd
var a=1732584193
var b=-271733879
var c=-1732584194
var d=271733878
for(i=0;i<x.length;i+=16){olda=a
oldb=b
oldc=c
oldd=d
a=md5_ff(a,b,c,d,x[i],7,-680876936)
d=md5_ff(d,a,b,c,x[i+1],12,-389564586)
c=md5_ff(c,d,a,b,x[i+2],17,606105819)
b=md5_ff(b,c,d,a,x[i+3],22,-1044525330)
a=md5_ff(a,b,c,d,x[i+4],7,-176418897)
d=md5_ff(d,a,b,c,x[i+5],12,1200080426)
c=md5_ff(c,d,a,b,x[i+6],17,-1473231341)
b=md5_ff(b,c,d,a,x[i+7],22,-45705983)
a=md5_ff(a,b,c,d,x[i+8],7,1770035416)
d=md5_ff(d,a,b,c,x[i+9],12,-1958414417)
c=md5_ff(c,d,a,b,x[i+10],17,-42063)
b=md5_ff(b,c,d,a,x[i+11],22,-1990404162)
a=md5_ff(a,b,c,d,x[i+12],7,1804603682)
d=md5_ff(d,a,b,c,x[i+13],12,-40341101)
c=md5_ff(c,d,a,b,x[i+14],17,-1502002290)
b=md5_ff(b,c,d,a,x[i+15],22,1236535329)
a=md5_gg(a,b,c,d,x[i+1],5,-165796510)
d=md5_gg(d,a,b,c,x[i+6],9,-1069501632)
c=md5_gg(c,d,a,b,x[i+11],14,643717713)
b=md5_gg(b,c,d,a,x[i],20,-373897302)
a=md5_gg(a,b,c,d,x[i+5],5,-701558691)
d=md5_gg(d,a,b,c,x[i+10],9,38016083)
c=md5_gg(c,d,a,b,x[i+15],14,-660478335)
b=md5_gg(b,c,d,a,x[i+4],20,-405537848)
a=md5_gg(a,b,c,d,x[i+9],5,568446438)
d=md5_gg(d,a,b,c,x[i+14],9,-1019803690)
c=md5_gg(c,d,a,b,x[i+3],14,-187363961)
b=md5_gg(b,c,d,a,x[i+8],20,1163531501)
a=md5_gg(a,b,c,d,x[i+13],5,-1444681467)
d=md5_gg(d,a,b,c,x[i+2],9,-51403784)
c=md5_gg(c,d,a,b,x[i+7],14,1735328473)
b=md5_gg(b,c,d,a,x[i+12],20,-1926607734)
a=md5_hh(a,b,c,d,x[i+5],4,-378558)
d=md5_hh(d,a,b,c,x[i+8],11,-2022574463)
c=md5_hh(c,d,a,b,x[i+11],16,1839030562)
b=md5_hh(b,c,d,a,x[i+14],23,-35309556)
a=md5_hh(a,b,c,d,x[i+1],4,-1530992060)
d=md5_hh(d,a,b,c,x[i+4],11,1272893353)
c=md5_hh(c,d,a,b,x[i+7],16,-155497632)
b=md5_hh(b,c,d,a,x[i+10],23,-1094730640)
a=md5_hh(a,b,c,d,x[i+13],4,681279174)
d=md5_hh(d,a,b,c,x[i],11,-358537222)
c=md5_hh(c,d,a,b,x[i+3],16,-722521979)
b=md5_hh(b,c,d,a,x[i+6],23,76029189)
a=md5_hh(a,b,c,d,x[i+9],4,-640364487)
d=md5_hh(d,a,b,c,x[i+12],11,-421815835)
c=md5_hh(c,d,a,b,x[i+15],16,530742520)
b=md5_hh(b,c,d,a,x[i+2],23,-995338651)
a=md5_ii(a,b,c,d,x[i],6,-198630844)
d=md5_ii(d,a,b,c,x[i+7],10,1126891415)
c=md5_ii(c,d,a,b,x[i+14],15,-1416354905)
b=md5_ii(b,c,d,a,x[i+5],21,-57434055)
a=md5_ii(a,b,c,d,x[i+12],6,1700485571)
d=md5_ii(d,a,b,c,x[i+3],10,-1894986606)
c=md5_ii(c,d,a,b,x[i+10],15,-1051523)
b=md5_ii(b,c,d,a,x[i+1],21,-2054922799)
a=md5_ii(a,b,c,d,x[i+8],6,1873313359)
d=md5_ii(d,a,b,c,x[i+15],10,-30611744)
c=md5_ii(c,d,a,b,x[i+6],15,-1560198380)
b=md5_ii(b,c,d,a,x[i+13],21,1309151649)
a=md5_ii(a,b,c,d,x[i+4],6,-145523070)
d=md5_ii(d,a,b,c,x[i+11],10,-1120210379)
c=md5_ii(c,d,a,b,x[i+2],15,718787259)
b=md5_ii(b,c,d,a,x[i+9],21,-343485551)
a=safe_add(a,olda)
b=safe_add(b,oldb)
c=safe_add(c,oldc)
d=safe_add(d,oldd)}
return[a,b,c,d]}
function binl2rstr(input){var i
var output=''
for(i=0;i<input.length*32;i+=8){output+=String.fromCharCode((input[i>>5]>>>(i%32))&0xFF)}
return output}
function rstr2binl(input){var i
var output=[]
output[(input.length>>2)-1]=undefined
for(i=0;i<output.length;i+=1){output[i]=0}
for(i=0;i<input.length*8;i+=8){output[i>>5]|=(input.charCodeAt(i/8)&0xFF)<<(i%32)}
return output}
function rstr_md5(s){return binl2rstr(binl_md5(rstr2binl(s),s.length*8))}
function rstr_hmac_md5(key,data){var i
var bkey=rstr2binl(key)
var ipad=[]
var opad=[]
var hash
ipad[15]=opad[15]=undefined
if(bkey.length>16){bkey=binl_md5(bkey,key.length*8)}
for(i=0;i<16;i+=1){ipad[i]=bkey[i]^0x36363636
opad[i]=bkey[i]^0x5C5C5C5C}
hash=binl_md5(ipad.concat(rstr2binl(data)),512+data.length*8)
return binl2rstr(binl_md5(opad.concat(hash),512+128))}
function rstr2hex(input){var hex_tab='0123456789abcdef'
var output=''
var x
var i
for(i=0;i<input.length;i+=1){x=input.charCodeAt(i)
output+=hex_tab.charAt((x>>>4)&0x0F)+
hex_tab.charAt(x&0x0F)}
return output}
function str2rstr_utf8(input){return unescape(encodeURIComponent(input))}
function raw_md5(s){return rstr_md5(str2rstr_utf8(s))}
function hex_md5(s){return rstr2hex(raw_md5(s))}
function raw_hmac_md5(k,d){return rstr_hmac_md5(str2rstr_utf8(k),str2rstr_utf8(d))}
function hex_hmac_md5(k,d){return rstr2hex(raw_hmac_md5(k,d))}
function md5(string,key,raw){if(!key){if(!raw){return hex_md5(string)}
return raw_md5(string)}
if(!raw){return hex_hmac_md5(key,string)}
return raw_hmac_md5(key,string)}
return md5;};},function(module,exports){"use strict";var StringUtils={};StringUtils.isBlack=function(str){return!(str&&typeof str==='string'&&str.length>0);};var StorageUtils={};StorageUtils.addItem=function(key,val){wx.setStorage({'key':key.toString(),'data':val});}
StorageUtils.removeItems=function(val){wx.getStorageInfo({success:function(res){var keys=res.keys;var ar=[];keys.forEach(function(item){try{var value=wx.getStorageSync(item);if(value===val){ar.push(item);}}catch(e){}});ar.forEach(function(it){wx.removeStorage({key:it,success:function(res){}})});}})}
StorageUtils.getItem=function(key){return wx.getStorageSync(key);}
StorageUtils.checkRepeatItems=function(items,val){var msgs=new Array();for(var i=0;i<items.length;i++){var ar=[];items[i].msgs.forEach(function(item){if(!wx.getStorageSync(item.msg_id.toString())||wx.getStorageSync(item.msg_id.toString())!=val){ar.push(item);}});if(ar.length>0){var m={'key':items[i].key,'msgs':ar};msgs.push(m);}}
return msgs;}
module.exports={StringUtils:StringUtils,StorageUtils:StorageUtils};}])});;